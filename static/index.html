<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>北斗视频</title>
</head>
<body>
	<div id="cmsv6flash"></div>
	<script src='https://unpkg.com/jquery@3.3.1/dist/jquery.min.js'></script>
	<script src="bd/swfobject.js"></script>
	<script type="text/javascript">
		var isInitFinished = false;//视频插件是否加载完成
		//初始化视频插件
		function initPlayerExample(jsession) {
		      //视频插件初始化参数
		      var params = {
		        allowFullscreen: "true",
		        allowScriptAccess: "always",
		        bgcolor: "#FFFFFF",
		        wmode: "transparent"
		        };
		      //初始化flash
		      swfobject.embedSWF("bd/player.swf", "cmsv6flash", 800, 800, "11.0.0", null, null, params, null);
		      initFlash(jsession);
		}
		//视频插件是否加载完成
		function initFlash(jsession) {
		      if (swfobject.getObjectById("cmsv6flash") == null ||
		            typeof swfobject.getObjectById("cmsv6flash").setWindowNum == "undefined" ) {
		            setTimeout(initFlash, 50);
		      } else {
		            //设置视频插件的语言
		            swfobject.getObjectById("cmsv6flash").setLanguage("bd/cn.xml");
		            //先将全部窗口创建好
		            swfobject.getObjectById("cmsv6flash").setWindowNum(36);
		            //再配置当前的窗口数目
		            swfobject.getObjectById("cmsv6flash").setWindowNum(4);
		            //设置视频插件的服务器
		            swfobject.getObjectById("cmsv6flash").setServerInfo("118.190.139.152", "6605");

		            swfobject.getObjectById("cmsv6flash").setVideoInfo(0, "12345-CH4");
					//播放视频
					swfobject.getObjectById("cmsv6flash").startVideo(3, jsession, '12345', 3, 0, true);
		            isInitFinished = true;
		    }
		}
		// initPlayerExample()
		function login() {
			$.ajax({
				url: 'http://118.190.139.152:8080/StandardApiAction_login.action?account=caocao&password=000000',
				method: 'get',
				dataType: 'json'
			}).then(res => {
				// console.log('then:', res)
				// initPlayerExample()
				if(0 == res.result) {
					initPlayerExample(res.jsession)
					$.ajax({
						url: 'http://118.190.139.152:8080/StandardApiAction_queryUserVehicle.action?jsession=' + res.jsession,
						method: 'get',
						dataType: 'json'
					}).then(r => {
						console.log(r)
					})
				}
			})
		}
		login()
	</script>
</body>
</html>